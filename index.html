<!doctype html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cross-Origin-Opener-Policy" content="same-origin-allow-popups" />
    <meta http-equiv="Cross-Origin-Embedder-Policy" content="credentialless" />
    <meta http-equiv="Cross-Origin-Resource-Policy" content="cross-origin" />
    <title>Salon Karte</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
    <script>
      // GitHub Pagesでの404エラーを防ぐためのリダイレクト
      ;(function (l) {
        if (l.search[1] === '/') {
          var decoded = l.search
            .slice(1)
            .split('&')
            .map(function (s) {
              return s.replace(/~and~/g, '&')
            })
            .join('?')
          window.history.replaceState(null, null, l.pathname.slice(0, -1) + decoded + l.hash)
        }
      })(window.location)

      // 認証状態の確認とリダイレクト処理
      window.addEventListener('load', function () {
        const currentPath = window.location.pathname
        const basePath = '/salon-karte/'
        const hash = window.location.hash

        // 認証関連のパスの場合は処理しない
        if (currentPath.includes('/__/auth/')) {
          return
        }

        // ログインページの場合は処理しない
        if (hash.includes('/login')) {
          return
        }

        // basePathが含まれる場合のみリダイレクト
        if (currentPath.startsWith(basePath)) {
          const newPath = currentPath.replace(basePath, '/')
          window.history.replaceState(null, null, newPath + hash)
        }
      })
    </script>
  </head>
  <body>
    <div id="app"></div>
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
